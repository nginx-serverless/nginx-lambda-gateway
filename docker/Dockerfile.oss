FROM nginx

LABEL maintainer="Shawn"

RUN mkdir -p /etc/nginx/aws     && \
    mkdir -p /etc/nginx/conf.d  && \
    mkdir -p /etc/nginx/gateway

RUN chmod -R 644 /etc/nginx
RUN chmod -R 644 /etc/nginx/aws
RUN chmod -R 644 /etc/nginx/conf.d
RUN chmod -R 644 /etc/nginx/gateway

COPY  core/*                        /etc/nginx/aws/
COPY  common/etc/nginx/nginx.conf   /etc/nginx/
COPY  common/etc/nginx/gateway/*    /etc/nginx/gateway/

STOPSIGNAL SIGTERM
CMD ["nginx", "-g", "daemon off;"]
